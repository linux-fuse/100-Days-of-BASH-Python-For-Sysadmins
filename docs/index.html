<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>100 Days of BASH & Python — For Sysadmins</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.4.1/dist/tailwind.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
</head>
<body class="bg-slate-50 text-slate-900">

  <div class="max-w-7xl mx-auto p-4">
    <header class="flex items-center justify-between mb-6">
      <div>
        <h1 class="text-2xl font-bold">100 Days of BASH & Python — For Sysadmins</h1>
        <p class="text-sm text-slate-600">Practical scripts, YouTube tutorials, and code highlights for sysadmins.</p>
      </div>
      <nav class="flex gap-3">
        <a href="#" class="text-sm underline">About</a>
        <a href="#" class="text-sm underline">Contribute</a>
        <a href="content/scripts.json" class="text-sm underline">Raw JSON</a>
      </nav>
    </header>

    <main class="grid grid-cols-1 md:grid-cols-4 gap-4">
      <aside class="md:col-span-1 bg-white rounded-xl shadow p-3 sticky top-4 h-[70vh] overflow-auto">
        <input id="search" placeholder="Search scripts..." class="w-full p-2 border rounded mb-3">
        <h3 class="font-semibold mb-2">Table of Contents</h3>
        <ol id="toc" class="list-decimal pl-5 text-sm"></ol>
      </aside>

      <article id="content" class="md:col-span-3 bg-white rounded-xl shadow p-5 overflow-auto">
        <p>Loading scripts...</p>
      </article>
    </main>

    <footer class="mt-6 text-sm text-slate-500 text-center">
      Built for GitHub Pages — edit <code>/docs/content/scripts.json</code> to add or modify pages.
    </footer>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>

  <script>
    async function loadScripts() {
      const response = await fetch('content/scripts.json');
      const data = await response.json();
      const toc = document.getElementById('toc');
      const content = document.getElementById('content');
      const search = document.getElementById('search');

      let active = data[0];
      renderTOC();
      renderContent(active);

      search.addEventListener('input', () => {
        const query = search.value.toLowerCase();
        const filtered = data.filter(s => s.title.toLowerCase().includes(query) || s.description.toLowerCase().includes(query));
        renderTOC(filtered);
      });

      function renderTOC(list = data) {
        toc.innerHTML = '';
        list.forEach(script => {
          const li = document.createElement('li');
          li.className = 'mb-2 cursor-pointer hover:text-indigo-600';
          li.textContent = script.title;
          li.onclick = () => { active = script; renderContent(script); };
          toc.appendChild(li);
        });
      }

      function renderContent(script) {
        content.innerHTML = `
          <h2 class="text-xl font-bold mb-1">${script.title}</h2>
          <div class="text-sm text-slate-600 mb-3">${script.description}</div>
          <div class="text-xs mb-4 text-slate-500">Language: <code>${script.lang}</code></div>
          <pre class="rounded-lg overflow-auto p-3 border"><code class="language-${script.lang}">${script.code.replace(/[&<>]/g, t => ({'&':'&amp;','<':'&lt;','>':'&gt;'}[t]))}</code></pre>
          ${script.video ? `
            <div class="mt-4">
              <h4 class="font-semibold mb-2">Video walk-through</h4>
              <div class="aspect-video rounded overflow-hidden">
                <iframe width="100%" height="315" src="https://www.youtube.com/embed/${script.video}" frameborder="0" allowfullscreen></iframe>
              </div>
            </div>` : ''}
          ${script.links?.length ? `<div class="mt-4">${script.links.map(l => `<a href='${l.url}' class='underline text-sm mr-3' target='_blank'>${l.title}</a>`).join('')}</div>` : ''}
        `;
        Prism.highlightAll();
      }
    }

    loadScripts().catch(err => {
      document.getElementById('content').textContent = 'Error loading content: ' + err;
    });
  </script>
</body>
</html>
